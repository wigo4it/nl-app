<div ng-controller="NLapp.MapLinksEditor as ctrl" class="umb-editor umb-contentpicker">
    <ng-form name="maplinksPickerForm">

        <div ui-sortable="ctrl.sortableOptions" ng-model="ctrl.renderModel">
            <div ng-repeat="link in ctrl.renderModel">
                <umb-node-preview icon="link.icon"
                                  name="link.name"
                                  published="link.published"
                                  description="link.url"
                                  sortable="!ctrl.sortableOptions.disabled"
                                  allow-remove="true"
                                  allow-open="true"
                                  on-remove="ctrl.remove($index)"
                                  on-open="ctrl.openMapLinkPicker(link, $index)">
                </umb-node-preview>
            </div>
        </div>

        <a ng-show="!model.config.maplinksMax || ctrl.renderModel.length < model.config.maplinksMax"
           class="umb-node-preview-add"
           href="#"
           ng-click="ctrl.openMapLinkPicker()"
           prevent-default>
            <localize key="general_add">Add</localize>
        </a>

        <input type="hidden" name="maxCount" ng-model="ctrl.renderModel" />

        <div class="help-inline" val-msg-for="maxCount" val-toggle-msg="maxCount">
            <localize key="validation_maxcount"></localize> {{model.config.maplinksMax}}
        </div>

    </ng-form>

    <umb-overlay ng-if="ctrl.maplinkPickerOverlay.show"
                 model="ctrl.maplinkPickerOverlay"
                 view="ctrl.maplinkPickerOverlay.view"
                 position="right">
    </umb-overlay>
</div>
